Copyright 2024-2025 The Trivalent Authors

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software distributed under the License is
distributed on an "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and limitations under the License.
---
diff --git a/net/dns/public/doh_provider_entry.cc b/net/dns/public/doh_provider_entry.cc
index 910a0c91aa1fa..bfe959f1475f2 100644
--- a/net/dns/public/doh_provider_entry.cc
+++ b/net/dns/public/doh_provider_entry.cc
@@ -77,7 +77,7 @@ const DohProviderEntry::List& DohProviderEntry::GetList() {
         /*ui_name=*/"alekberg.net (NL)",
         /*privacy_policy=*/"https://alekberg.net/privacy",
         /*display_globally=*/false,
-        /*display_countries=*/{"NL"}, LoggingLevel::kNormal},
+        /*display_countries=*/{}, LoggingLevel::kNormal},
        {"CleanBrowsingAdult",
         MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderCleanBrowsingAdult,
                                               base::FEATURE_ENABLED_BY_DEFAULT),
@@ -99,7 +99,7 @@ const DohProviderEntry::List& DohProviderEntry::GetList() {
         "https://doh.cleanbrowsing.org/doh/family-filter{?dns}",
         /*ui_name=*/"CleanBrowsing (Family Filter)",
         /*privacy_policy=*/"https://cleanbrowsing.org/privacy",
-        /*display_globally=*/true,
+        /*display_globally=*/false,
         /*display_countries=*/{},
         LoggingLevel::kNormal},
        {"CleanBrowsingSecure",
@@ -117,15 +117,107 @@ const DohProviderEntry::List& DohProviderEntry::GetList() {
         MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderCloudflare,
                                               base::FEATURE_ENABLED_BY_DEFAULT),
         {"1.1.1.1", "1.0.0.1", "2606:4700:4700::1111", "2606:4700:4700::1001"},
-        /*dns_over_tls_hostnames=*/
-        {"one.one.one.one", "1dot1dot1dot1.cloudflare-dns.com"},
-        "https://chrome.cloudflare-dns.com/dns-query",
+        /*dns_over_tls_hostnames=*/{"one.one.one.one", "cloudflare-dns.com",
+        "1dot1dot1dot1.cloudflare-dns.com"},
+        "https://cloudflare-dns.com/dns-query",
         /*ui_name=*/"Cloudflare (1.1.1.1)",
         "https://developers.cloudflare.com/1.1.1.1/privacy/"
         /*privacy_policy=*/"public-dns-resolver/",
         /*display_globally=*/true,
         /*display_countries=*/{},
         LoggingLevel::kExtra},
+       // Source for Cloudflare IP addresses and hostnames/URLs: https://developers.cloudflare.com/1.1.1.1/infrastructure/network-operators/#available-endpoints
+       {"CloudflareSecurity",
+        MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderCloudflareSecurity,
+                                              base::FEATURE_ENABLED_BY_DEFAULT),
+        {"1.1.1.2", "1.0.0.2", "2606:4700:4700::1112", "2606:4700:4700::1002"},
+        /*dns_over_tls_hostnames=*/{"security.cloudflare-dns.com"},
+        "https://security.cloudflare-dns.com/dns-query",
+        /*ui_name=*/"Cloudflare (Malware Filter)",
+        "https://developers.cloudflare.com/1.1.1.1/privacy/"
+        /*privacy_policy=*/"public-dns-resolver/",
+        /*display_globally=*/true,
+        /*display_countries=*/{},
+        LoggingLevel::kExtra},
+       {"CloudflareFamily",
+        MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderCloudflareFamily,
+                                              base::FEATURE_ENABLED_BY_DEFAULT),
+        {"1.1.1.3", "1.0.0.3", "2606:4700:4700::1113", "2606:4700:4700::1003"},
+        /*dns_over_tls_hostnames=*/{"family.cloudflare-dns.com"},
+        "https://family.cloudflare-dns.com/dns-query",
+        /*ui_name=*/"Cloudflare (Family Filter)",
+        "https://developers.cloudflare.com/1.1.1.1/privacy/"
+        /*privacy_policy=*/"public-dns-resolver/",
+        /*display_globally=*/true,
+        /*display_countries=*/{},
+        LoggingLevel::kExtra},
+       // Source for Control D IP addresses and hostnames/URLs: https://controld.com/free-dns
+       {"ControlD",
+        MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderControlD,
+                                              base::FEATURE_ENABLED_BY_DEFAULT),
+        {"76.76.2.0", "76.76.10.0", "2606:1a40::", "2606:1a40:1::"},
+        /*dns_over_tls_hostnames=*/{"p0.freedns.controld.com"},
+        "https://freedns.controld.com/p0",
+        /*ui_name=*/"",
+        /*privacy_policy=*/"",
+        /*display_globally=*/false,
+        /*display_countries=*/{},
+        LoggingLevel::kExtra},
+       {"ControlDMalware",
+        MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderControlDMalware,
+                                              base::FEATURE_ENABLED_BY_DEFAULT),
+        {"76.76.2.1", "76.76.10.1", "2606:1a40::1", "2606:1a40:1::1"},
+        /*dns_over_tls_hostnames=*/{"p1.freedns.controld.com"},
+        "https://freedns.controld.com/p1",
+        /*ui_name=*/"Control D (Malware Filtering)",
+        /*privacy_policy=*/"https://controld.com/privacy",
+        /*display_globally=*/true,
+        /*display_countries=*/{},
+        LoggingLevel::kExtra},
+       {"ControlDStandard",
+        MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderControlDStandard,
+                                              base::FEATURE_ENABLED_BY_DEFAULT),
+        {"76.76.2.2", "76.76.10.2", "2606:1a40::2", "2606:1a40:1::2"},
+        /*dns_over_tls_hostnames=*/{"p2.freedns.controld.com"},
+        "https://freedns.controld.com/p2",
+        /*ui_name=*/"Control D (Tracking & Malware Filtering)",
+        /*privacy_policy=*/"https://controld.com/privacy",
+        /*display_globally=*/true,
+        /*display_countries=*/{},
+        LoggingLevel::kExtra},
+       {"ControlDSocial",
+        MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderControlDSocial,
+                                              base::FEATURE_ENABLED_BY_DEFAULT),
+        {"76.76.2.3", "76.76.10.3", "2606:1a40::3", "2606:1a40:1::3"},
+        /*dns_over_tls_hostnames=*/{"p3.freedns.controld.com"},
+        "https://freedns.controld.com/p3",
+        /*ui_name=*/"",
+        /*privacy_policy=*/"",
+        /*display_globally=*/false,
+        /*display_countries=*/{},
+        LoggingLevel::kExtra},
+       {"ControlDFamily",
+        MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderControlDFamily,
+                                              base::FEATURE_ENABLED_BY_DEFAULT),
+        {"76.76.2.4", "76.76.10.4", "2606:1a40::4", "2606:1a40:1::4"},
+        /*dns_over_tls_hostnames=*/{"family.freedns.controld.com"},
+        "https://freedns.controld.com/family",
+        /*ui_name=*/"Control D (Tracking & Family Filtering)",
+        /*privacy_policy=*/"https://controld.com/privacy",
+        /*display_globally=*/true,
+        /*display_countries=*/{},
+        LoggingLevel::kExtra},
+       {"ControlDUncensored",
+        MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderControlDUncensored,
+                                              base::FEATURE_ENABLED_BY_DEFAULT),
+        {"76.76.2.5", "76.76.10.5", "2606:1a40::5", "2606:1a40:1::5"},
+        /*dns_over_tls_hostnames=*/{"uncensored.freedns.controld.com"},
+        "https://freedns.controld.com/uncensored",
+        /*ui_name=*/"",
+        /*privacy_policy=*/"",
+        /*display_globally=*/false,
+        /*display_countries=*/{},
+        LoggingLevel::kExtra},
        {"Comcast",
         MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderComcast,
                                               base::FEATURE_ENABLED_BY_DEFAULT),
@@ -181,7 +273,7 @@ const DohProviderEntry::List& DohProviderEntry::GetList() {
         /*ui_name=*/"Google (Public DNS)",
         "https://developers.google.com/speed/public-dns/"
         /*privacy_policy=*/"privacy",
-        /*display_globally=*/true,
+        /*display_globally=*/false,
         /*display_countries=*/{},
         LoggingLevel::kExtra},
        {"GoogleDns64",
@@ -225,7 +317,7 @@ const DohProviderEntry::List& DohProviderEntry::GetList() {
         /*dns_over_tls_hostnames=*/{}, "https://chromium.dns.nextdns.io",
         /*ui_name=*/"NextDNS",
         /*privacy_policy=*/"https://nextdns.io/privacy",
-        /*display_globally=*/false, /*display_countries=*/{"US"},
+        /*display_globally=*/false, /*display_countries=*/{},
         LoggingLevel::kNormal},
        {"OpenDNS",
         MAKE_BASE_FEATURE_WITH_STATIC_STORAGE(DohProviderOpenDNS,
@@ -237,7 +329,7 @@ const DohProviderEntry::List& DohProviderEntry::GetList() {
         /*ui_name=*/"OpenDNS",
         "https://www.cisco.com/c/en/us/about/legal/"
         /*privacy_policy=*/"privacy-full.html",
-        /*display_globally=*/true,
+        /*display_globally=*/false,
         /*display_countries=*/{},
         LoggingLevel::kNormal},
        {"OpenDNSFamily",
@@ -282,7 +374,7 @@ const DohProviderEntry::List& DohProviderEntry::GetList() {
         "https://dns.quad9.net/dns-query",
         /*ui_name=*/"Quad9 (9.9.9.9)",
         /*privacy_policy=*/"https://www.quad9.net/home/privacy/",
-        /*display_globally=*/true,
+        /*display_globally=*/false,
         /*display_countries=*/{},
         LoggingLevel::kExtra},
        {"Quickline",

name: Release Trivalent

on:
  workflow_run:
    workflows: ["build-debian"]
    types: [completed]

permissions:
  contents: write
  actions: write

jobs:
  release:
    name: Create GitHub release (Debian x86_64)
    if: |
      github.event.workflow_run.conclusion == 'success' &&
      startsWith(github.event.workflow_run.head_branch, 'gl-trivalent-v')
    uses: mattycramer/gh-actions/.github/workflows/release-from-workflow-run.yml@abcb12137e26fac12c3ed60252327a1f96a7b601
    with:
      tag: ${{ github.event.workflow_run.head_branch }}
      tag_prefix: gl-trivalent-v
      allow_revision_suffix: true
      run_id: ${{ github.event.workflow_run.id }}
      artifact_prefix: trivalent-debian-
      tarball_prefix: trivalent-debian-x86_64-
      checksum_prefix: trivalent-sha256-checksums-
      release_name: Trivalent v{version}
    secrets: inherit
